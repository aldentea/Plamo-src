--- libgd2-2.0.36~rc1~dfsg.orig/debian/patches/0001_fix_leak_in_gdImageCopyResized.patch
+++ libgd2-2.0.36~rc1~dfsg/debian/patches/0001_fix_leak_in_gdImageCopyResized.patch
@@ -0,0 +1,28 @@
+diff -ruN libgd2.orig/NEWS libgd2/NEWS
+--- libgd2.orig/NEWS	2007-11-27 09:30:34.000000000 +0100
++++ libgd2/NEWS	2008-03-06 12:42:06.000000000 +0100
+@@ -1,6 +1,7 @@
+ 'GD                                                                         NEWS
+ |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
+ GD 2.0.36 (2007-11-xx)
++145, Fixed keak in gdImageCopyResized (Patch by Brent Bottles)
+  81, Fixed gdImageCopy with true color image, the transparent color was ignored
+      (Pierre, Mark Fisher)
+  88, Fixed support of PNG grayscale image with alpha channel (Pierre)
+diff -ruN libgd2.orig/gd.c libgd2/gd.c
+--- libgd2.orig/gd.c	2007-11-27 09:30:34.000000000 +0100
++++ libgd2/gd.c	2008-03-06 12:42:06.000000000 +0100
+@@ -1,4 +1,4 @@
+-/* $Id: gd.c,v 1.49.2.24 2007/11/20 13:42:11 pajoye Exp $ */
++/* $Id: gd.c,v 1.49.2.25 2008/02/01 01:52:25 pajoye Exp $ */
+ #ifdef HAVE_CONFIG_H
+ #include "config.h"
+ #endif
+@@ -2486,6 +2486,7 @@
+ 
+   sty = (int *) gdMalloc (sizeof (int) * srcH);
+ 	if (!sty) {
++		gdFree(stx);
+ 		return;
+ 	}
+ 
--- libgd2-2.0.36~rc1~dfsg.orig/debian/patches/0002_CVE-2009-3546.patch
+++ libgd2-2.0.36~rc1~dfsg/debian/patches/0002_CVE-2009-3546.patch
@@ -0,0 +1,15 @@
+CVE-2009-3546: buffer overflow or buffer over-read attacks via a crafted GD file
+http://svn.php.net/viewvc?view=revision&revision=289557
+--- a/gd_gd.c
++++ b/gd_gd.c
+@@ -44,6 +44,10 @@ _gdGetColors (gdIOCtx * in, gdImagePtr i
+ 	    {
+ 	      goto fail1;
+ 	    }
++	  if (im->colorsTotal > gdMaxColors)
++	    {
++	      goto fail1;
++	    }
+ 	}
+       /* Int to accommodate truecolor single-color transparency */
+       if (!gdGetInt (&im->transparent, in))
