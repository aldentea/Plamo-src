diff -uNr grep-2.20.orig/src/kwset.c grep-2.20/src/kwset.c
--- grep-2.20.orig/src/kwset.c	2014-05-11 10:45:01.000000000 +0900
+++ grep-2.20/src/kwset.c	2015-02-13 15:51:17.267115980 +0900
@@ -643,6 +643,8 @@
                     if (! tp)
                       return -1;
                     tp++;
+		    if (ep <= tp)
+		      break;
                   }
               }
           }
